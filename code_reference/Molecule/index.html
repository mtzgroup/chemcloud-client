
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <meta name="author" content="Colton Hicks">
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.3">
    
    
      
        <title>Molecule - tccloud</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1655a90d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.7fa14f5b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="amber">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#molecule" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="tccloud" class="md-header__button md-logo" aria-label="tccloud">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            tccloud
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Molecule
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/mtzgroup/tccloud/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="tccloud" class="md-nav__button md-logo" aria-label="tccloud">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    tccloud
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/mtzgroup/tccloud/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        tccloud
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" data-md-state="indeterminate" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        Tutorial - Users Guide
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Tutorial - Users Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Tutorial - Users Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/compute/" class="md-nav__link">
        Compute
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/compute_engines/" class="md-nav__link">
        Compute Engines
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/authentication/" class="md-nav__link">
        Authentication
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/geometry_optimization/" class="md-nav__link">
        Geometry Optimization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/batch_computations/" class="md-nav__link">
        Batch Computations
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      <label class="md-nav__link" for="__nav_3">
        Code Reference
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Code Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Code Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../TCClient/" class="md-nav__link">
        TCClient
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../FutureResult/" class="md-nav__link">
        FutureResult
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Molecule
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Molecule
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-the-model-object" class="md-nav__link">
    Import the Model object
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-molecule" class="md-nav__link">
    Create a Molecule
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#save-a-molecule-to-a-file" class="md-nav__link">
    Save a Molecule to a file
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#oft-used-attributes" class="md-nav__link">
    Oft-used Attributes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#molecule-full-reference" class="md-nav__link">
    Molecule Full Reference
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule" class="md-nav__link">
    qcelemental.models.molecule.Molecule
  </a>
  
    <nav class="md-nav" aria-label="qcelemental.models.molecule.Molecule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule--notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule-attributes" class="md-nav__link">
    Attributes
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.atom_labels" class="md-nav__link">
    atom_labels
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.atom_labels_" class="md-nav__link">
    atom_labels_
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.atomic_numbers" class="md-nav__link">
    atomic_numbers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.atomic_numbers_" class="md-nav__link">
    atomic_numbers_
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.comment" class="md-nav__link">
    comment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.connectivity" class="md-nav__link">
    connectivity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.connectivity_" class="md-nav__link">
    connectivity_
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.extras" class="md-nav__link">
    extras
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.fields" class="md-nav__link">
    fields
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.fix_com" class="md-nav__link">
    fix_com
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.fix_orientation" class="md-nav__link">
    fix_orientation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.fix_symmetry" class="md-nav__link">
    fix_symmetry
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.fragment_charges" class="md-nav__link">
    fragment_charges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.fragment_charges_" class="md-nav__link">
    fragment_charges_
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.fragment_multiplicities" class="md-nav__link">
    fragment_multiplicities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.fragment_multiplicities_" class="md-nav__link">
    fragment_multiplicities_
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.fragments" class="md-nav__link">
    fragments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.fragments_" class="md-nav__link">
    fragments_
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.geometry" class="md-nav__link">
    geometry
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.hash_fields" class="md-nav__link">
    hash_fields
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.id" class="md-nav__link">
    id
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.identifiers" class="md-nav__link">
    identifiers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.mass_numbers" class="md-nav__link">
    mass_numbers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.mass_numbers_" class="md-nav__link">
    mass_numbers_
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.masses" class="md-nav__link">
    masses
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.masses_" class="md-nav__link">
    masses_
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.molecular_charge" class="md-nav__link">
    molecular_charge
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.molecular_multiplicity" class="md-nav__link">
    molecular_multiplicity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.provenance" class="md-nav__link">
    provenance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.real" class="md-nav__link">
    real
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.real_" class="md-nav__link">
    real_
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.schema_name" class="md-nav__link">
    schema_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.schema_version" class="md-nav__link">
    schema_version
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.symbols" class="md-nav__link">
    symbols
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.validated" class="md-nav__link">
    validated
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.Config" class="md-nav__link">
    Config
  </a>
  
    <nav class="md-nav" aria-label="Config">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.Config.allow_mutation" class="md-nav__link">
    allow_mutation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.Config.extra" class="md-nav__link">
    extra
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.Config.force_skip_defaults" class="md-nav__link">
    force_skip_defaults
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.Config.json_encoders" class="md-nav__link">
    json_encoders
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.Config.serialize_default_excludes" class="md-nav__link">
    serialize_default_excludes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.Config.serialize_skip_defaults" class="md-nav__link">
    serialize_skip_defaults
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.Config.repr_style" class="md-nav__link">
    repr_style()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.Config.schema_extra" class="md-nav__link">
    schema_extra()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule-methods" class="md-nav__link">
    Methods
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.__init__" class="md-nav__link">
    __init__()
  </a>
  
    <nav class="md-nav" aria-label="__init__()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.__init__--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.align" class="md-nav__link">
    align()
  </a>
  
    <nav class="md-nav" aria-label="align()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.align--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.align--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.compare" class="md-nav__link">
    compare()
  </a>
  
    <nav class="md-nav" aria-label="compare()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.compare--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.compare--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.dict" class="md-nav__link">
    dict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.from_data" class="md-nav__link">
    from_data()
  </a>
  
    <nav class="md-nav" aria-label="from_data()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.from_data--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.from_data--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.from_file" class="md-nav__link">
    from_file()
  </a>
  
    <nav class="md-nav" aria-label="from_file()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.from_file--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.from_file--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.get_fragment" class="md-nav__link">
    get_fragment()
  </a>
  
    <nav class="md-nav" aria-label="get_fragment()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.get_fragment--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.get_fragment--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.get_hash" class="md-nav__link">
    get_hash()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.get_molecular_formula" class="md-nav__link">
    get_molecular_formula()
  </a>
  
    <nav class="md-nav" aria-label="get_molecular_formula()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.get_molecular_formula--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.get_molecular_formula--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.get_molecular_formula--examples" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.json" class="md-nav__link">
    json()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.measure" class="md-nav__link">
    measure()
  </a>
  
    <nav class="md-nav" aria-label="measure()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.measure--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.measure--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.nelectrons" class="md-nav__link">
    nelectrons()
  </a>
  
    <nav class="md-nav" aria-label="nelectrons()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.nelectrons--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.nelectrons--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.nuclear_repulsion_energy" class="md-nav__link">
    nuclear_repulsion_energy()
  </a>
  
    <nav class="md-nav" aria-label="nuclear_repulsion_energy()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.nuclear_repulsion_energy--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.nuclear_repulsion_energy--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.orient_molecule" class="md-nav__link">
    orient_molecule()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.pretty_print" class="md-nav__link">
    pretty_print()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.scramble" class="md-nav__link">
    scramble()
  </a>
  
    <nav class="md-nav" aria-label="scramble()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.scramble--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.scramble--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.scramble--raises" class="md-nav__link">
    Raises
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.serialize" class="md-nav__link">
    serialize()
  </a>
  
    <nav class="md-nav" aria-label="serialize()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.serialize--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.serialize--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.show" class="md-nav__link">
    show()
  </a>
  
    <nav class="md-nav" aria-label="show()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.show--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.show--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.to_file" class="md-nav__link">
    to_file()
  </a>
  
    <nav class="md-nav" aria-label="to_file()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.to_file--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.to_string" class="md-nav__link">
    to_string()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../AtomicInput/" class="md-nav__link">
        AtomicInput
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../AtomicResult/" class="md-nav__link">
        AtomicResult
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../OptimizationInput/" class="md-nav__link">
        Optimization Input
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../OptimizationResult/" class="md-nav__link">
        Optimization Result
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../FailedOperation/" class="md-nav__link">
        FailedOperation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ComputeError/" class="md-nav__link">
        ComputeError
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../exceptions/" class="md-nav__link">
        Exceptions
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../CHANGELOG/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-the-model-object" class="md-nav__link">
    Import the Model object
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-molecule" class="md-nav__link">
    Create a Molecule
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#save-a-molecule-to-a-file" class="md-nav__link">
    Save a Molecule to a file
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#oft-used-attributes" class="md-nav__link">
    Oft-used Attributes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#molecule-full-reference" class="md-nav__link">
    Molecule Full Reference
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule" class="md-nav__link">
    qcelemental.models.molecule.Molecule
  </a>
  
    <nav class="md-nav" aria-label="qcelemental.models.molecule.Molecule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule--notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule-attributes" class="md-nav__link">
    Attributes
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.atom_labels" class="md-nav__link">
    atom_labels
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.atom_labels_" class="md-nav__link">
    atom_labels_
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.atomic_numbers" class="md-nav__link">
    atomic_numbers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.atomic_numbers_" class="md-nav__link">
    atomic_numbers_
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.comment" class="md-nav__link">
    comment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.connectivity" class="md-nav__link">
    connectivity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.connectivity_" class="md-nav__link">
    connectivity_
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.extras" class="md-nav__link">
    extras
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.fields" class="md-nav__link">
    fields
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.fix_com" class="md-nav__link">
    fix_com
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.fix_orientation" class="md-nav__link">
    fix_orientation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.fix_symmetry" class="md-nav__link">
    fix_symmetry
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.fragment_charges" class="md-nav__link">
    fragment_charges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.fragment_charges_" class="md-nav__link">
    fragment_charges_
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.fragment_multiplicities" class="md-nav__link">
    fragment_multiplicities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.fragment_multiplicities_" class="md-nav__link">
    fragment_multiplicities_
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.fragments" class="md-nav__link">
    fragments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.fragments_" class="md-nav__link">
    fragments_
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.geometry" class="md-nav__link">
    geometry
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.hash_fields" class="md-nav__link">
    hash_fields
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.id" class="md-nav__link">
    id
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.identifiers" class="md-nav__link">
    identifiers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.mass_numbers" class="md-nav__link">
    mass_numbers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.mass_numbers_" class="md-nav__link">
    mass_numbers_
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.masses" class="md-nav__link">
    masses
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.masses_" class="md-nav__link">
    masses_
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.molecular_charge" class="md-nav__link">
    molecular_charge
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.molecular_multiplicity" class="md-nav__link">
    molecular_multiplicity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.provenance" class="md-nav__link">
    provenance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.real" class="md-nav__link">
    real
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.real_" class="md-nav__link">
    real_
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.schema_name" class="md-nav__link">
    schema_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.schema_version" class="md-nav__link">
    schema_version
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.symbols" class="md-nav__link">
    symbols
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.validated" class="md-nav__link">
    validated
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.Config" class="md-nav__link">
    Config
  </a>
  
    <nav class="md-nav" aria-label="Config">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.Config.allow_mutation" class="md-nav__link">
    allow_mutation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.Config.extra" class="md-nav__link">
    extra
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.Config.force_skip_defaults" class="md-nav__link">
    force_skip_defaults
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.Config.json_encoders" class="md-nav__link">
    json_encoders
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.Config.serialize_default_excludes" class="md-nav__link">
    serialize_default_excludes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.Config.serialize_skip_defaults" class="md-nav__link">
    serialize_skip_defaults
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.Config.repr_style" class="md-nav__link">
    repr_style()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.Config.schema_extra" class="md-nav__link">
    schema_extra()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule-methods" class="md-nav__link">
    Methods
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.__init__" class="md-nav__link">
    __init__()
  </a>
  
    <nav class="md-nav" aria-label="__init__()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.__init__--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.align" class="md-nav__link">
    align()
  </a>
  
    <nav class="md-nav" aria-label="align()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.align--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.align--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.compare" class="md-nav__link">
    compare()
  </a>
  
    <nav class="md-nav" aria-label="compare()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.compare--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.compare--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.dict" class="md-nav__link">
    dict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.from_data" class="md-nav__link">
    from_data()
  </a>
  
    <nav class="md-nav" aria-label="from_data()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.from_data--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.from_data--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.from_file" class="md-nav__link">
    from_file()
  </a>
  
    <nav class="md-nav" aria-label="from_file()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.from_file--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.from_file--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.get_fragment" class="md-nav__link">
    get_fragment()
  </a>
  
    <nav class="md-nav" aria-label="get_fragment()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.get_fragment--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.get_fragment--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.get_hash" class="md-nav__link">
    get_hash()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.get_molecular_formula" class="md-nav__link">
    get_molecular_formula()
  </a>
  
    <nav class="md-nav" aria-label="get_molecular_formula()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.get_molecular_formula--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.get_molecular_formula--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.get_molecular_formula--examples" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.json" class="md-nav__link">
    json()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.measure" class="md-nav__link">
    measure()
  </a>
  
    <nav class="md-nav" aria-label="measure()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.measure--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.measure--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.nelectrons" class="md-nav__link">
    nelectrons()
  </a>
  
    <nav class="md-nav" aria-label="nelectrons()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.nelectrons--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.nelectrons--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.nuclear_repulsion_energy" class="md-nav__link">
    nuclear_repulsion_energy()
  </a>
  
    <nav class="md-nav" aria-label="nuclear_repulsion_energy()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.nuclear_repulsion_energy--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.nuclear_repulsion_energy--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.orient_molecule" class="md-nav__link">
    orient_molecule()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.pretty_print" class="md-nav__link">
    pretty_print()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.scramble" class="md-nav__link">
    scramble()
  </a>
  
    <nav class="md-nav" aria-label="scramble()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.scramble--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.scramble--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.scramble--raises" class="md-nav__link">
    Raises
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.serialize" class="md-nav__link">
    serialize()
  </a>
  
    <nav class="md-nav" aria-label="serialize()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.serialize--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.serialize--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.show" class="md-nav__link">
    show()
  </a>
  
    <nav class="md-nav" aria-label="show()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.show--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.show--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.to_file" class="md-nav__link">
    to_file()
  </a>
  
    <nav class="md-nav" aria-label="to_file()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.to_file--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qcelemental.models.molecule.Molecule.to_string" class="md-nav__link">
    to_string()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/mtzgroup/tccloud/edit/develop/docs/code_reference/Molecule.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="molecule">Molecule<a class="headerlink" href="#molecule" title="Permanent link"></a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link"></a></h2>
<p>The <code>Molecule</code> object is the core representation of a molecule used throughout <code>tccloud</code>. The <code>molecule</code> object is from the <code>qcelemental.models</code> module, but it is available in the <code>tccloud.models</code> module for your convenience. You can access the QCElemental documentation on the <code>Molecule</code> <a href="http://docs.qcarchive.molssi.org/projects/QCElemental/en/stable/model_molecule.html">here</a>. It is assumed that all geometries are in <code>bohr</code>.</p>
<h2 id="import-the-model-object">Import the Model object<a class="headerlink" href="#import-the-model-object" title="Permanent link"></a></h2>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">tccloud.models</span> <span class="kn">import</span> <span class="n">Molecule</span>
</code></pre></div>
<h2 id="create-a-molecule">Create a Molecule<a class="headerlink" href="#create-a-molecule" title="Permanent link"></a></h2>
<p>Molecules can be created directly from data on <a href="https://pubchem.ncbi.nlm.nih.gov">pubchem</a>, a python string, a <code>psi4</code> file, an <code>xyz</code> file, an <code>xyz+</code> file, or a <code>json</code> file.</p>
<p>Pubchem:</p>
<div class="highlight"><pre><span></span><code><span class="n">water</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span><span class="s2">&quot;pubchem:water&quot;</span><span class="p">)</span>
</code></pre></div>
<p>From Files:</p>
<div class="highlight"><pre><span></span><code><span class="n">water</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;water.xyz&quot;</span><span class="p">)</span>
<span class="n">water</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;water.psi4&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="save-a-molecule-to-a-file">Save a Molecule to a file<a class="headerlink" href="#save-a-molecule-to-a-file" title="Permanent link"></a></h2>
<div class="highlight"><pre><span></span><code><span class="n">water</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span><span class="s2">&quot;pubchem:water&quot;</span><span class="p">)</span>
<span class="c1"># JSON is the prefered format since it preserves the most information</span>
<span class="n">water</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s2">&quot;water.json&quot;</span><span class="p">)</span>
<span class="n">water</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s2">&quot;water.xyz&quot;</span><span class="p">)</span>
<span class="n">water</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s2">&quot;water.psi4&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="oft-used-attributes">Oft-used Attributes<a class="headerlink" href="#oft-used-attributes" title="Permanent link"></a></h2>
<div class="highlight"><pre><span></span><code><span class="n">water</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span><span class="s2">&quot;pubchem:water&quot;</span><span class="p">)</span>
<span class="n">water</span><span class="o">.</span><span class="n">symbols</span>
<span class="n">array</span><span class="p">([</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;&lt;U1&#39;</span><span class="p">)</span><span class="n">water</span><span class="o">.</span><span class="n">symbols</span>

<span class="n">water</span><span class="o">.</span><span class="n">geometry</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.52421003</span><span class="p">,</span>  <span class="mf">1.68733646</span><span class="p">,</span>  <span class="mf">0.48074633</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">1.14668581</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.45032174</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.35474466</span><span class="p">]])</span>

<span class="c1"># All Attributes</span>
<span class="n">attrs</span> <span class="o">=</span> <span class="p">[</span><span class="n">attr</span> <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">water</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">attr</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">attrs</span><span class="p">)</span>
</code></pre></div>
<h2 id="molecule-full-reference">Molecule Full Reference<a class="headerlink" href="#molecule-full-reference" title="Permanent link"></a></h2>


  <div class="doc doc-object doc-class">

<a id="qcelemental.models.molecule.Molecule"></a>
    <div class="doc doc-contents first">

      <p>The physical Cartesian representation of the molecular system.</p>
<p>A QCSchema representation of a Molecule. This model contains
data for symbols, geometry, connectivity, charges, fragmentation, etc while also supporting a wide array of I/O and manipulation capabilities.</p>
<p>Molecule objects geometry, masses, and charges are truncated to 8, 6, and 4 decimal places respectively to assist with duplicate detection.</p>
<h3 id="qcelemental.models.molecule.Molecule--notes">Notes<a class="headerlink" href="#qcelemental.models.molecule.Molecule--notes" title="Permanent link"></a></h3>
<p>All arrays are stored flat but must be reshapable into the dimensions in attribute <code>shape</code>, with abbreviations as follows:
    nat: number of atomic = calcinfo_natom
    nfr: number of fragments
    <varies>: irregular dimension not systematically reshapable</p>




  <div class="doc doc-children">




<h2 id="qcelemental.models.molecule.Molecule-attributes">Attributes<a class="headerlink" href="#qcelemental.models.molecule.Molecule-attributes" title="Permanent link"></a></h2>

  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.atom_labels">
<code class="highlight language-python"><span class="n">atom_labels</span><span class="p">:</span> <span class="n">Array</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.atom_labels" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.atom_labels_">
<code class="highlight language-python"><span class="n">atom_labels_</span><span class="p">:</span> <span class="n">Array</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.atom_labels_" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Additional per-atom labels as an array of strings. Typical use is in model conversions, such as Elemental &lt;-&gt; Molpro and not typically something which should be user assigned. See the <code>comments</code> field for general human-consumable text to affix to the molecule.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.atomic_numbers">
<code class="highlight language-python"><span class="n">atomic_numbers</span><span class="p">:</span> <span class="n">Array</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.atomic_numbers" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.atomic_numbers_">
<code class="highlight language-python"><span class="n">atomic_numbers_</span><span class="p">:</span> <span class="n">Array</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.atomic_numbers_" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>An optional ordered 1-D array-like object of atomic numbers of shape (nat,). Index matches the 0-indexed indices of all other per-atom settings like <code>symbols</code> and <code>real</code>. Values are inferred from the <code>symbols</code> list if not explicitly set. Ghostedness should be indicated through <code>real</code> field, not zeros here.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.comment">
<code class="highlight language-python"><span class="n">comment</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.comment" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Additional comments for this molecule. Intended for pure human/user consumption and clarity.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.connectivity">
<code class="highlight language-python"><span class="n">connectivity</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.connectivity" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.connectivity_">
<code class="highlight language-python"><span class="n">connectivity_</span><span class="p">:</span> <span class="n">ConstrainedListValue</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.connectivity_" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>A list of bonds within the molecule. Each entry is a tuple of <code>(atom_index_A, atom_index_B, bond_order)</code> where the <code>atom_index</code> matches the 0-indexed indices of all other per-atom settings like <code>symbols</code> and <code>real</code>. Bonds may be freely reordered and inverted.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.extras">
<code class="highlight language-python"><span class="n">extras</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.extras" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Additional information to bundle with the molecule. Use for schema development and scratch space.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.fields">
<code class="highlight language-python"><span class="n">fields</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">ModelField</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.fields" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.fix_com">
<code class="highlight language-python"><span class="n">fix_com</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.fix_com" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Whether translation of geometry is allowed (fix F) or disallowed (fix T).When False, QCElemental will pre-process the Molecule object to translate the center of mass to (0,0,0) in Euclidean coordinate space, resulting in a different <code>geometry</code> than the one provided. guidance: A consumer who translates the geometry must not reattach the input (pre-translation) molecule schema instance to any output (post-translation) origin-sensitive results (e.g., an ordinary energy when EFP present).</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.fix_orientation">
<code class="highlight language-python"><span class="n">fix_orientation</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.fix_orientation" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Whether rotation of geometry is allowed (fix F) or disallowed (fix T). When False, QCElemental will pre-process the Molecule object to orient via the intertial tensor, resulting in a different <code>geometry</code> than the one provided. guidance: A consumer who rotates the geometry must not reattach the input (pre-rotation) molecule schema instance to any output (post-rotation) frame-sensitive results (e.g., molecular vibrations).</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.fix_symmetry">
<code class="highlight language-python"><span class="n">fix_symmetry</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.fix_symmetry" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Maximal point group symmetry which <code>geometry</code> should be treated. Lowercase.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.fragment_charges">
<code class="highlight language-python"><span class="n">fragment_charges</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.fragment_charges" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.fragment_charges_">
<code class="highlight language-python"><span class="n">fragment_charges_</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.fragment_charges_" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>The total charge of each fragment in the <code>fragments</code> list. The index of this list matches the 0-index indices of <code>fragments</code> list. Will be filled in based on a set of rules if not provided (and <code>fragments</code> are specified).</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.fragment_multiplicities">
<code class="highlight language-python"><span class="n">fragment_multiplicities</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.fragment_multiplicities" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.fragment_multiplicities_">
<code class="highlight language-python"><span class="n">fragment_multiplicities_</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.fragment_multiplicities_" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>The multiplicity of each fragment in the <code>fragments</code> list. The index of this list matches the 0-index indices of <code>fragments</code> list. Will be filled in based on a set of rules if not provided (and <code>fragments</code> are specified).</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.fragments">
<code class="highlight language-python"><span class="n">fragments</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">qcelemental</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">Array</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.fragments" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.fragments_">
<code class="highlight language-python"><span class="n">fragments_</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">qcelemental</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">Array</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.fragments_" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>List of indices grouping atoms (0-indexed) into molecular fragments within the molecule. Each entry in the outer list is a new fragment; index matches the ordering in <code>fragment_charges</code> and <code>fragment_multiplicities</code>. Inner lists are 0-indexed atoms which compose the fragment; every atom must be in exactly one inner list. Noncontiguous fragments are allowed, though no QM program is known to support them. Fragment ordering is fixed; that is, a consumer who shuffles fragments must not reattach the input (pre-shuffling) molecule schema instance to any output (post-shuffling) per-fragment results (e.g., n-body energy arrays).</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.geometry">
<code class="highlight language-python"><span class="n">geometry</span><span class="p">:</span> <span class="n">Array</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.geometry" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>The ordered array for Cartesian XYZ atomic coordinates [a0]. Atom ordering is fixed; that is, a consumer who shuffles atoms must not reattach the input (pre-shuffling) molecule schema instance to any output (post-shuffling) per-atom results (e.g., gradient). Index of the first dimension matches the 0-indexed indices of all other per-atom settings like <code>symbols</code> and <code>real</code>.
Serialized storage is always flat, (3<em>nat,), but QCSchema implementations will want to reshape it. QCElemental can also accept array-likes which can be mapped to (nat,3) such as a 1-D list of length 3</em>nat, or the serialized version of the array in (3*nat,) shape; all forms will be reshaped to (nat,3) for this attribute.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.hash_fields">
<code class="highlight language-python"><span class="n">hash_fields</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.hash_fields" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.id">
<code class="highlight language-python"><span class="nb">id</span><span class="p">:</span> <span class="n">Any</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.id" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>A unique identifier for this Molecule object. This field exists primarily for Databases (e.g. Fractal's Server) to track and lookup this specific object and should virtually never need to be manually set.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.identifiers">
<code class="highlight language-python"><span class="n">identifiers</span><span class="p">:</span> <span class="n">Identifiers</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.identifiers" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>An optional dictionary of additional identifiers by which this molecule can be referenced, such as INCHI, canonical SMILES, etc. See the :class:<code>Identifiers</code> model for more details.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.mass_numbers">
<code class="highlight language-python"><span class="n">mass_numbers</span><span class="p">:</span> <span class="n">Array</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.mass_numbers" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.mass_numbers_">
<code class="highlight language-python"><span class="n">mass_numbers_</span><span class="p">:</span> <span class="n">Array</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.mass_numbers_" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>An optional ordered 1-D array-like object of atomic <em>mass</em> numbers of shape (nat). Index matches the 0-indexed indices of all other per-atom settings like <code>symbols</code> and <code>real</code>. Values are inferred from the most common isotopes of the <code>symbols</code> list if not explicitly set. If single isotope not (yet) known for an atom, -1 is placeholder.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.masses">
<code class="highlight language-python"><span class="n">masses</span><span class="p">:</span> <span class="n">Array</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.masses" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.masses_">
<code class="highlight language-python"><span class="n">masses_</span><span class="p">:</span> <span class="n">Array</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.masses_" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>The ordered array of atomic masses. Index order matches the 0-indexed indices of all other per-atom fields like <code>symbols</code> and <code>real</code>. If this is not provided, the mass of each atom is inferred from its most common isotope. If this is provided, it must be the same length as <code>symbols</code> but can accept <code>None</code> entries for standard masses to infer from the same index in the <code>symbols</code> field.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.molecular_charge">
<code class="highlight language-python"><span class="n">molecular_charge</span><span class="p">:</span> <span class="nb">float</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.molecular_charge" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>The net electrostatic charge of the molecule.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.molecular_multiplicity">
<code class="highlight language-python"><span class="n">molecular_multiplicity</span><span class="p">:</span> <span class="nb">int</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.molecular_multiplicity" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>The total multiplicity of the molecule.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.name">
<code class="highlight language-python"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.name" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Common or human-readable name to assign to this molecule. This field can be arbitrary; see <code>identifiers</code> for well-defined labels.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.provenance">
<code class="highlight language-python"><span class="n">provenance</span><span class="p">:</span> <span class="n">Provenance</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.provenance" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>The provenance information about how this Molecule (and its attributes) were generated, provided, and manipulated.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.real">
<code class="highlight language-python"><span class="n">real</span><span class="p">:</span> <span class="n">Array</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.real" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.real_">
<code class="highlight language-python"><span class="n">real_</span><span class="p">:</span> <span class="n">Array</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.real_" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>The ordered array indicating if each atom is real (<code>True</code>) or ghost/virtual (<code>False</code>). Index matches the 0-indexed indices of all other per-atom settings like <code>symbols</code> and the first dimension of <code>geometry</code>. If this is not provided, all atoms are assumed to be real (<code>True</code>).If this is provided, the reality or ghostedness of every atom must be specified.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.schema_name">
<code class="highlight language-python"><span class="n">schema_name</span><span class="p">:</span> <span class="n">ConstrainedStrValue</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.schema_name" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>The QCSchema specification to which this model conforms. Explicitly fixed as qcschema_molecule.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.schema_version">
<code class="highlight language-python"><span class="n">schema_version</span><span class="p">:</span> <span class="nb">int</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.schema_version" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>The version number of <code>schema_name</code> to which this model conforms.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.symbols">
<code class="highlight language-python"><span class="n">symbols</span><span class="p">:</span> <span class="n">Array</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.symbols" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>The ordered array of atomic elemental symbols in title case. This field's index sets atomic order for all other per-atom fields like <code>real</code> and the first dimension of <code>geometry</code>. Ghost/virtual atoms must have an entry here in <code>symbols</code>; ghostedness is indicated through the <code>real</code> field.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.validated">
<code class="highlight language-python"><span class="n">validated</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.validated" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>A boolean indicator (for speed purposes) that the input Molecule data has been previously checked for schema (data layout and type) and physics (e.g., non-overlapping atoms, feasible multiplicity) compliance. This should be False in most cases. A <code>True</code> setting should only ever be set by the constructor for this class itself or other trusted sources such as a Fractal Server or previously serialized Molecules.</p>
    </div>

  </div>




  <div class="doc doc-object doc-class">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.Config">
        <code>Config</code>



<a class="headerlink" href="#qcelemental.models.molecule.Molecule.Config" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">





  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h5 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.Config.allow_mutation">
<code class="highlight language-python"><span class="n">allow_mutation</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.Config.allow_mutation" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.Config.extra">
<code class="highlight language-python"><span class="n">extra</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.Config.extra" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.Config.force_skip_defaults">
<code class="highlight language-python"><span class="n">force_skip_defaults</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.Config.force_skip_defaults" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.Config.json_encoders">
<code class="highlight language-python"><span class="n">json_encoders</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.Config.json_encoders" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.Config.serialize_default_excludes">
<code class="highlight language-python"><span class="n">serialize_default_excludes</span><span class="p">:</span> <span class="n">Set</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.Config.serialize_default_excludes" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.Config.serialize_skip_defaults">
<code class="highlight language-python"><span class="n">serialize_skip_defaults</span><span class="p">:</span> <span class="nb">bool</span></code>


<a class="headerlink" href="#qcelemental.models.molecule.Molecule.Config.serialize_skip_defaults" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

    </div>

  </div>






  <div class="doc doc-object doc-method">



<h5 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.Config.repr_style">
<code class="highlight language-python"><span class="n">repr_style</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a class="headerlink" href="#qcelemental.models.molecule.Molecule.Config.repr_style" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>qcelemental/models/molecule.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="n">repr_style</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;formula&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_molecular_formula</span><span class="p">()),</span>
    <span class="p">(</span><span class="s2">&quot;hash&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_hash</span><span class="p">()[:</span><span class="mi">7</span><span class="p">]),</span>
<span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.Config.schema_extra">
<code class="highlight language-python"><span class="n">schema_extra</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span></code>


<a class="headerlink" href="#qcelemental.models.molecule.Molecule.Config.schema_extra" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>qcelemental/models/molecule.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">schema_extra</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
    <span class="c1"># below addresses the draft-04 issue until https://github.com/samuelcolvin/pydantic/issues/1478 .</span>
    <span class="n">schema</span><span class="p">[</span><span class="s2">&quot;$schema&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qcschema_draft</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



<h2 id="qcelemental.models.molecule.Molecule-methods">Methods<a class="headerlink" href="#qcelemental.models.molecule.Molecule-methods" title="Permanent link"></a></h2>

  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orient</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">validate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.__init__" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Initializes the molecule object from dictionary-like values.</p>
<h5 id="qcelemental.models.molecule.Molecule.__init__--parameters">Parameters<a class="headerlink" href="#qcelemental.models.molecule.Molecule.__init__--parameters" title="Permanent link"></a></h5>
<p>orient : bool, optional
    If True, orientates the Molecule to a common reference frame.
validate : Optional[bool], optional
    If <code>None</code> validation is always applied unless the <code>validated</code> flag is set. Otherwise uses the boolean to decide to validate the Molecule or not.
**kwargs : Any
    The values of the Molecule object attributes.</p>

        <details class="quote">
          <summary>Source code in <code>qcelemental/models/molecule.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orient</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">validate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Initializes the molecule object from dictionary-like values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    orient : bool, optional</span>
<span class="sd">        If True, orientates the Molecule to a common reference frame.</span>
<span class="sd">    validate : Optional[bool], optional</span>
<span class="sd">        If ``None`` validation is always applied unless the ``validated`` flag is set. Otherwise uses the boolean to decide to validate the Molecule or not.</span>
<span class="sd">    **kwargs : Any</span>
<span class="sd">        The values of the Molecule object attributes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">validate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">validate</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;validated&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="n">geometry_prep</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;_geometry_prep&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">validate</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;schema_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;schema_name&quot;</span><span class="p">,</span> <span class="s2">&quot;qcschema_molecule&quot;</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;schema_version&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;schema_version&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="c1"># original_keys = set(kwargs.keys())  # revive when ready to revisit sparsity</span>

        <span class="n">nonphysical</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;nonphysical&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">schema</span> <span class="o">=</span> <span class="n">to_schema</span><span class="p">(</span>
            <span class="n">from_schema</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">nonphysical</span><span class="o">=</span><span class="n">nonphysical</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;schema_version&quot;</span><span class="p">],</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">np_out</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="n">schema</span> <span class="o">=</span> <span class="n">_filter_defaults</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>

        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;validated&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="o">**</span><span class="n">schema</span><span class="p">}</span>  <span class="c1"># Allow any extra fields</span>
        <span class="n">validate</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># We are pulling out the values *explicitly* so that the pydantic skip_defaults works as expected</span>
    <span class="c1"># All attributes set below are equivalent to the default set.</span>
    <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>

    <span class="k">if</span> <span class="n">validate</span><span class="p">:</span>
        <span class="n">values</span><span class="p">[</span><span class="s2">&quot;symbols&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">defchararray</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">)</span>  <span class="c1"># Title case for consistency</span>

    <span class="k">if</span> <span class="n">orient</span><span class="p">:</span>
        <span class="n">values</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">float_prep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_orient_molecule_internal</span><span class="p">(),</span> <span class="n">GEOMETRY_NOISE</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">validate</span> <span class="ow">or</span> <span class="n">geometry_prep</span><span class="p">:</span>
        <span class="n">values</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">float_prep</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">],</span> <span class="n">GEOMETRY_NOISE</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.align">
<code class="highlight language-python"><span class="n">align</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_mol</span><span class="p">:</span> <span class="n">Molecule</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">do_plot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">atoms_map</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">run_resorting</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">mols_align</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">run_to_completion</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">uno_cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span> <span class="n">run_mirror</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span></code>


<a class="headerlink" href="#qcelemental.models.molecule.Molecule.align" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Finds shift, rotation, and atom reordering of <code>concern_mol</code> (self)
that best aligns with <code>ref_mol</code>.</p>
<p>Wraps <img alt="" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/1f1f5-1f1fe.svg" title=":py:" />func:<code>qcel.molutil.B787</code> for <img alt="" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/1f1f5-1f1fe.svg" title=":py:" />class:<code>qcel.models.Molecule</code>.
Employs the Kabsch, Hungarian, and Uno algorithms to exhaustively locate
the best alignment for non-oriented, non-ordered structures.</p>
<h5 id="qcelemental.models.molecule.Molecule.align--parameters">Parameters<a class="headerlink" href="#qcelemental.models.molecule.Molecule.align--parameters" title="Permanent link"></a></h5>
<p>ref_mol : qcel.models.Molecule
    Molecule to match.
atoms_map : bool, optional
    Whether atom1 of <code>ref_mol</code> corresponds to atom1 of <code>concern_mol</code>, etc.
    If true, specifying <code>True</code> can save much time.
mols_align : bool or float, optional
    Whether ref_mol and concern_mol have identical geometries
    (barring orientation or atom mapping) and expected final RMSD = 0.
    If <code>True</code>, procedure is truncated when RMSD condition met, saving time.
    If float, RMSD tolerance at which search for alignment stops. If provided,
    the alignment routine will throw an error if it fails to align
    the molecule within the specified RMSD tolerance.
do_plot : bool, optional
    Pops up a mpl plot showing before, after, and ref geometries.
run_to_completion : bool, optional
    Run reorderings to completion (past RMSD = 0) even if unnecessary because
    <code>mols_align=True</code>. Used to test worst-case timings.
run_resorting : bool, optional
    Run the resorting machinery even if unnecessary because <code>atoms_map=True</code>.
uno_cutoff : float, optional
    TODO
run_mirror : bool, optional
    Run alternate geometries potentially allowing best match to <code>ref_mol</code>
    from mirror image of <code>concern_mol</code>. Only run if system confirmed to
    be nonsuperimposable upon mirror reflection.
verbose : int, optional
    Print level.</p>
<h5 id="qcelemental.models.molecule.Molecule.align--returns">Returns<a class="headerlink" href="#qcelemental.models.molecule.Molecule.align--returns" title="Permanent link"></a></h5>
<p>Molecule, data
    Molecule is internal geometry of <code>self</code> optimally aligned and atom-ordered
      to <code>ref_mol</code>. Presently all fragment information is discarded.
    <code>data['rmsd']</code> is RMSD [A] between <code>ref_mol</code> and the optimally aligned
    geometry computed.
    <code>data['mill']</code> is a AlignmentMill with fields
    (shift, rotation, atommap, mirror) that prescribe the transformation
    from <code>concern_mol</code> and the optimally aligned geometry.</p>

        <details class="quote">
          <summary>Source code in <code>qcelemental/models/molecule.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">align</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">ref_mol</span><span class="p">:</span> <span class="s2">&quot;Molecule&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">do_plot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">atoms_map</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">run_resorting</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">mols_align</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">run_to_completion</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">uno_cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0e-3</span><span class="p">,</span>
    <span class="n">run_mirror</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Finds shift, rotation, and atom reordering of `concern_mol` (self)</span>
<span class="sd">    that best aligns with `ref_mol`.</span>

<span class="sd">    Wraps :py:func:`qcel.molutil.B787` for :py:class:`qcel.models.Molecule`.</span>
<span class="sd">    Employs the Kabsch, Hungarian, and Uno algorithms to exhaustively locate</span>
<span class="sd">    the best alignment for non-oriented, non-ordered structures.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ref_mol : qcel.models.Molecule</span>
<span class="sd">        Molecule to match.</span>
<span class="sd">    atoms_map : bool, optional</span>
<span class="sd">        Whether atom1 of `ref_mol` corresponds to atom1 of `concern_mol`, etc.</span>
<span class="sd">        If true, specifying `True` can save much time.</span>
<span class="sd">    mols_align : bool or float, optional</span>
<span class="sd">        Whether ref_mol and concern_mol have identical geometries</span>
<span class="sd">        (barring orientation or atom mapping) and expected final RMSD = 0.</span>
<span class="sd">        If `True`, procedure is truncated when RMSD condition met, saving time.</span>
<span class="sd">        If float, RMSD tolerance at which search for alignment stops. If provided,</span>
<span class="sd">        the alignment routine will throw an error if it fails to align</span>
<span class="sd">        the molecule within the specified RMSD tolerance.</span>
<span class="sd">    do_plot : bool, optional</span>
<span class="sd">        Pops up a mpl plot showing before, after, and ref geometries.</span>
<span class="sd">    run_to_completion : bool, optional</span>
<span class="sd">        Run reorderings to completion (past RMSD = 0) even if unnecessary because</span>
<span class="sd">        `mols_align=True`. Used to test worst-case timings.</span>
<span class="sd">    run_resorting : bool, optional</span>
<span class="sd">        Run the resorting machinery even if unnecessary because `atoms_map=True`.</span>
<span class="sd">    uno_cutoff : float, optional</span>
<span class="sd">        TODO</span>
<span class="sd">    run_mirror : bool, optional</span>
<span class="sd">        Run alternate geometries potentially allowing best match to `ref_mol`</span>
<span class="sd">        from mirror image of `concern_mol`. Only run if system confirmed to</span>
<span class="sd">        be nonsuperimposable upon mirror reflection.</span>
<span class="sd">    verbose : int, optional</span>
<span class="sd">        Print level.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Molecule, data</span>
<span class="sd">        Molecule is internal geometry of `self` optimally aligned and atom-ordered</span>
<span class="sd">          to `ref_mol`. Presently all fragment information is discarded.</span>
<span class="sd">        `data[&#39;rmsd&#39;]` is RMSD [A] between `ref_mol` and the optimally aligned</span>
<span class="sd">        geometry computed.</span>
<span class="sd">        `data[&#39;mill&#39;]` is a AlignmentMill with fields</span>
<span class="sd">        (shift, rotation, atommap, mirror) that prescribe the transformation</span>
<span class="sd">        from `concern_mol` and the optimally aligned geometry.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">..molutil.align</span> <span class="kn">import</span> <span class="n">B787</span>

    <span class="n">rgeom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ref_mol</span><span class="o">.</span><span class="n">geometry</span><span class="p">)</span>
    <span class="n">runiq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">((</span><span class="n">sym</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mas</span><span class="p">))</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">sym</span><span class="p">,</span> <span class="n">mas</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">ref_mol</span><span class="o">.</span><span class="n">symbols</span><span class="p">),</span> <span class="n">ref_mol</span><span class="o">.</span><span class="n">masses</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="n">concern_mol</span> <span class="o">=</span> <span class="bp">self</span>
    <span class="n">cgeom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">concern_mol</span><span class="o">.</span><span class="n">geometry</span><span class="p">)</span>
    <span class="n">cmass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">concern_mol</span><span class="o">.</span><span class="n">masses</span><span class="p">)</span>
    <span class="n">celem</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">concern_mol</span><span class="o">.</span><span class="n">symbols</span><span class="p">)</span>
    <span class="n">celez</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">concern_mol</span><span class="o">.</span><span class="n">atomic_numbers</span><span class="p">)</span>
    <span class="n">cuniq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">((</span><span class="n">sym</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mas</span><span class="p">))</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">sym</span><span class="p">,</span> <span class="n">mas</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">concern_mol</span><span class="o">.</span><span class="n">symbols</span><span class="p">),</span> <span class="n">concern_mol</span><span class="o">.</span><span class="n">masses</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="n">rmsd</span><span class="p">,</span> <span class="n">solution</span> <span class="o">=</span> <span class="n">B787</span><span class="p">(</span>
        <span class="n">cgeom</span><span class="o">=</span><span class="n">cgeom</span><span class="p">,</span>
        <span class="n">rgeom</span><span class="o">=</span><span class="n">rgeom</span><span class="p">,</span>
        <span class="n">cuniq</span><span class="o">=</span><span class="n">cuniq</span><span class="p">,</span>
        <span class="n">runiq</span><span class="o">=</span><span class="n">runiq</span><span class="p">,</span>
        <span class="n">do_plot</span><span class="o">=</span><span class="n">do_plot</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
        <span class="n">atoms_map</span><span class="o">=</span><span class="n">atoms_map</span><span class="p">,</span>
        <span class="n">run_resorting</span><span class="o">=</span><span class="n">run_resorting</span><span class="p">,</span>
        <span class="n">mols_align</span><span class="o">=</span><span class="n">mols_align</span><span class="p">,</span>
        <span class="n">run_to_completion</span><span class="o">=</span><span class="n">run_to_completion</span><span class="p">,</span>
        <span class="n">run_mirror</span><span class="o">=</span><span class="n">run_mirror</span><span class="p">,</span>
        <span class="n">uno_cutoff</span><span class="o">=</span><span class="n">uno_cutoff</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">ageom</span><span class="p">,</span> <span class="n">amass</span><span class="p">,</span> <span class="n">aelem</span><span class="p">,</span> <span class="n">aelez</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">align_system</span><span class="p">(</span><span class="n">cgeom</span><span class="p">,</span> <span class="n">cmass</span><span class="p">,</span> <span class="n">celem</span><span class="p">,</span> <span class="n">celez</span><span class="p">,</span> <span class="n">cuniq</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">adict</span> <span class="o">=</span> <span class="n">from_arrays</span><span class="p">(</span>
        <span class="n">geom</span><span class="o">=</span><span class="n">ageom</span><span class="p">,</span>
        <span class="n">mass</span><span class="o">=</span><span class="n">amass</span><span class="p">,</span>
        <span class="n">elem</span><span class="o">=</span><span class="n">aelem</span><span class="p">,</span>
        <span class="n">elez</span><span class="o">=</span><span class="n">aelez</span><span class="p">,</span>
        <span class="n">units</span><span class="o">=</span><span class="s2">&quot;Bohr&quot;</span><span class="p">,</span>
        <span class="n">molecular_charge</span><span class="o">=</span><span class="n">concern_mol</span><span class="o">.</span><span class="n">molecular_charge</span><span class="p">,</span>
        <span class="n">molecular_multiplicity</span><span class="o">=</span><span class="n">concern_mol</span><span class="o">.</span><span class="n">molecular_multiplicity</span><span class="p">,</span>
        <span class="n">fix_com</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">fix_orientation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">amol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">to_schema</span><span class="p">(</span><span class="n">adict</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

    <span class="c1"># TODO -- can probably do more with fragments in amol now that</span>
    <span class="c1">#         Mol is something with non-contig frags. frags now discarded.</span>

    <span class="k">assert</span> <span class="n">compare_values</span><span class="p">(</span>
        <span class="n">concern_mol</span><span class="o">.</span><span class="n">nuclear_repulsion_energy</span><span class="p">(),</span>
        <span class="n">amol</span><span class="o">.</span><span class="n">nuclear_repulsion_energy</span><span class="p">(),</span>
        <span class="s2">&quot;Q: concern_mol--&gt;returned_mol NRE uncorrupted&quot;</span><span class="p">,</span>
        <span class="n">atol</span><span class="o">=</span><span class="mf">1.0e-4</span><span class="p">,</span>
        <span class="n">quiet</span><span class="o">=</span><span class="p">(</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">mols_align</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">compare_values</span><span class="p">(</span>
            <span class="n">ref_mol</span><span class="o">.</span><span class="n">nuclear_repulsion_energy</span><span class="p">(),</span>
            <span class="n">amol</span><span class="o">.</span><span class="n">nuclear_repulsion_energy</span><span class="p">(),</span>
            <span class="s2">&quot;Q: concern_mol--&gt;returned_mol NRE matches ref_mol&quot;</span><span class="p">,</span>
            <span class="n">atol</span><span class="o">=</span><span class="mf">1.0e-4</span><span class="p">,</span>
            <span class="n">quiet</span><span class="o">=</span><span class="p">(</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="k">assert</span> <span class="n">compare</span><span class="p">(</span>
            <span class="kc">True</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">ref_mol</span><span class="o">.</span><span class="n">geometry</span><span class="p">,</span> <span class="n">amol</span><span class="o">.</span><span class="n">geometry</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
            <span class="s2">&quot;Q: concern_mol--&gt;returned_mol geometry matches ref_mol&quot;</span><span class="p">,</span>
            <span class="n">quiet</span><span class="o">=</span><span class="p">(</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">amol</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;rmsd&quot;</span><span class="p">:</span> <span class="n">rmsd</span><span class="p">,</span> <span class="s2">&quot;mill&quot;</span><span class="p">:</span> <span class="n">solution</span><span class="p">}</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.compare">
<code class="highlight language-python"><span class="n">compare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>


<a class="headerlink" href="#qcelemental.models.molecule.Molecule.compare" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Compares the current object to the provided object recursively.</p>
<h5 id="qcelemental.models.molecule.Molecule.compare--parameters">Parameters<a class="headerlink" href="#qcelemental.models.molecule.Molecule.compare--parameters" title="Permanent link"></a></h5>
<p>other : Model
    The model to compare to.
**kwargs
    Additional kwargs to pass to <code>qcelemental.compare_recursive</code>.</p>
<h5 id="qcelemental.models.molecule.Molecule.compare--returns">Returns<a class="headerlink" href="#qcelemental.models.molecule.Molecule.compare--returns" title="Permanent link"></a></h5>
<p>bool
    True if the objects match.</p>

        <details class="quote">
          <summary>Source code in <code>qcelemental/models/molecule.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">compare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
        <span class="s2">&quot;Molecule.compare is deprecated and will be removed in v0.13.0. Use == instead.&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">other</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.dict">
<code class="highlight language-python"><span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a class="headerlink" href="#qcelemental.models.molecule.Molecule.dict" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Generate a dictionary representation of the model, optionally specifying which fields to include or exclude.</p>

        <details class="quote">
          <summary>Source code in <code>qcelemental/models/molecule.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;by_alias&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;exclude_unset&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">dict</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.from_data">
<code class="highlight language-python"><span class="n">from_data</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">function</span> <span class="n">array</span><span class="o">&gt;</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">orient</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">validate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Molecule</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.from_data" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Constructs a molecule object from a data structure.</p>
<h5 id="qcelemental.models.molecule.Molecule.from_data--parameters">Parameters<a class="headerlink" href="#qcelemental.models.molecule.Molecule.from_data--parameters" title="Permanent link"></a></h5>
<p>data : Union[str, Dict[str, Any], np.array]
    Data to construct Molecule from
dtype : Optional[str], optional
    How to interpret the data, if not passed attempts to discover this based on input type.
orient : bool, optional
    Orientates the molecule to a standard frame or not.
validate : bool, optional
    Validates the molecule or not.
**kwargs : Dict[str, Any]
    Additional kwargs to pass to the constructors. kwargs take precedence over data.</p>
<h5 id="qcelemental.models.molecule.Molecule.from_data--returns">Returns<a class="headerlink" href="#qcelemental.models.molecule.Molecule.from_data--returns" title="Permanent link"></a></h5>
<p>Molecule
    A constructed molecule class.</p>

        <details class="quote">
          <summary>Source code in <code>qcelemental/models/molecule.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_data</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">orient</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">validate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Molecule&quot;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructs a molecule object from a data structure.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : Union[str, Dict[str, Any], np.array]</span>
<span class="sd">        Data to construct Molecule from</span>
<span class="sd">    dtype : Optional[str], optional</span>
<span class="sd">        How to interpret the data, if not passed attempts to discover this based on input type.</span>
<span class="sd">    orient : bool, optional</span>
<span class="sd">        Orientates the molecule to a standard frame or not.</span>
<span class="sd">    validate : bool, optional</span>
<span class="sd">        Validates the molecule or not.</span>
<span class="sd">    **kwargs : Dict[str, Any]</span>
<span class="sd">        Additional kwargs to pass to the constructors. kwargs take precedence over data.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Molecule</span>
<span class="sd">        A constructed molecule class.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="s2">&quot;string&quot;</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="s2">&quot;numpy&quot;</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="s2">&quot;dict&quot;</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="s2">&quot;msgpack&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Input type not understood, please supply the &#39;dtype&#39; kwarg.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;psi4&quot;</span><span class="p">,</span> <span class="s2">&quot;xyz&quot;</span><span class="p">,</span> <span class="s2">&quot;xyz+&quot;</span><span class="p">]:</span>
        <span class="n">mol_dict</span> <span class="o">=</span> <span class="n">from_string</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span> <span class="k">if</span> <span class="n">dtype</span> <span class="o">!=</span> <span class="s2">&quot;string&quot;</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mol_dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
        <span class="n">input_dict</span> <span class="o">=</span> <span class="n">to_schema</span><span class="p">(</span><span class="n">mol_dict</span><span class="p">[</span><span class="s2">&quot;qm&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">np_out</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">input_dict</span> <span class="o">=</span> <span class="n">_filter_defaults</span><span class="p">(</span><span class="n">input_dict</span><span class="p">)</span>
        <span class="n">input_dict</span><span class="p">[</span><span class="s2">&quot;validated&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">input_dict</span><span class="p">[</span><span class="s2">&quot;_geometry_prep&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">elif</span> <span class="n">dtype</span> <span class="o">==</span> <span class="s2">&quot;numpy&quot;</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;geom&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:],</span>
            <span class="s2">&quot;elez&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;units&quot;</span><span class="p">,</span> <span class="s2">&quot;Angstrom&quot;</span><span class="p">),</span>
            <span class="s2">&quot;fragment_separators&quot;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;frags&quot;</span><span class="p">,</span> <span class="p">[]),</span>
        <span class="p">}</span>
        <span class="n">input_dict</span> <span class="o">=</span> <span class="n">to_schema</span><span class="p">(</span><span class="n">from_arrays</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">np_out</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">input_dict</span> <span class="o">=</span> <span class="n">_filter_defaults</span><span class="p">(</span><span class="n">input_dict</span><span class="p">)</span>
        <span class="n">input_dict</span><span class="p">[</span><span class="s2">&quot;validated&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">input_dict</span><span class="p">[</span><span class="s2">&quot;_geometry_prep&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">elif</span> <span class="n">dtype</span> <span class="o">==</span> <span class="s2">&quot;msgpack&quot;</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span>
        <span class="n">input_dict</span> <span class="o">=</span> <span class="n">msgpackext_loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">dtype</span> <span class="o">==</span> <span class="s2">&quot;json&quot;</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="n">input_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">dtype</span> <span class="o">==</span> <span class="s2">&quot;dict&quot;</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
        <span class="n">input_dict</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Dtype not understood &#39;</span><span class="si">{}</span><span class="s2">&#39;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dtype</span><span class="p">))</span>

    <span class="n">input_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># if charge/spin options are given, invalidate charge and spin options that are missing</span>
    <span class="n">charge_spin_opts</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;molecular_charge&quot;</span><span class="p">,</span> <span class="s2">&quot;fragment_charges&quot;</span><span class="p">,</span> <span class="s2">&quot;molecular_multiplicity&quot;</span><span class="p">,</span> <span class="s2">&quot;fragment_multiplicities&quot;</span><span class="p">}</span>
    <span class="n">kwarg_keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">charge_spin_opts</span> <span class="o">&amp;</span> <span class="n">kwarg_keys</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">charge_spin_opts</span> <span class="o">-</span> <span class="n">kwarg_keys</span><span class="p">:</span>
            <span class="n">input_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">input_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;validated&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="n">orient</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="n">validate</span><span class="p">,</span> <span class="o">**</span><span class="n">input_dict</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.from_file">
<code class="highlight language-python"><span class="n">from_file</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">orient</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.from_file" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Constructs a molecule object from a file.</p>
<h5 id="qcelemental.models.molecule.Molecule.from_file--parameters">Parameters<a class="headerlink" href="#qcelemental.models.molecule.Molecule.from_file--parameters" title="Permanent link"></a></h5>
<p>filename : str
    The filename to build
dtype : Optional[str], optional
    The type of file to interpret.
orient : bool, optional
    Orientates the molecule to a standard frame or not.
**kwargs
    Any additional keywords to pass to the constructor</p>
<h5 id="qcelemental.models.molecule.Molecule.from_file--returns">Returns<a class="headerlink" href="#qcelemental.models.molecule.Molecule.from_file--returns" title="Permanent link"></a></h5>
<p>Molecule
    A constructed molecule class.</p>

        <details class="quote">
          <summary>Source code in <code>qcelemental/models/molecule.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">orient</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructs a molecule object from a file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename : str</span>
<span class="sd">        The filename to build</span>
<span class="sd">    dtype : Optional[str], optional</span>
<span class="sd">        The type of file to interpret.</span>
<span class="sd">    orient : bool, optional</span>
<span class="sd">        Orientates the molecule to a standard frame or not.</span>
<span class="sd">    **kwargs</span>
<span class="sd">        Any additional keywords to pass to the constructor</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Molecule</span>
<span class="sd">        A constructed molecule class.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ext</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span>

    <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">_extension_map</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">_extension_map</span><span class="p">[</span><span class="n">ext</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Let `from_string` try to sort it</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="s2">&quot;string&quot;</span>

    <span class="c1"># Raw string type, read and pass through</span>
    <span class="k">if</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;xyz&quot;</span><span class="p">,</span> <span class="s2">&quot;xyz+&quot;</span><span class="p">,</span> <span class="s2">&quot;psi4&quot;</span><span class="p">]:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">dtype</span> <span class="o">==</span> <span class="s2">&quot;numpy&quot;</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">dtype</span> <span class="o">==</span> <span class="s2">&quot;json&quot;</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="s2">&quot;dict&quot;</span>
    <span class="k">elif</span> <span class="n">dtype</span> <span class="o">==</span> <span class="s2">&quot;msgpack&quot;</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile_bytes</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">deserialize</span><span class="p">(</span><span class="n">infile_bytes</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;msgpack-ext&quot;</span><span class="p">)</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="s2">&quot;dict&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Dtype not understood &#39;</span><span class="si">{}</span><span class="s2">&#39;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dtype</span><span class="p">))</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="n">orient</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.get_fragment">
<code class="highlight language-python"><span class="n">get_fragment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">real</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">],</span> <span class="n">ghost</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">orient</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">group_fragments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Molecule</span></code>


<a class="headerlink" href="#qcelemental.models.molecule.Molecule.get_fragment" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Get new Molecule with fragments preserved, dropped, or ghosted.</p>
<h5 id="qcelemental.models.molecule.Molecule.get_fragment--parameters">Parameters<a class="headerlink" href="#qcelemental.models.molecule.Molecule.get_fragment--parameters" title="Permanent link"></a></h5>
<p>real
    Fragment index or list of indices (0-indexed) to be real atoms in new Molecule.
ghost
    Fragment index or list of indices (0-indexed) to be ghost atoms (basis fns only) in new Molecule.
orient
    Whether or not to align (inertial frame) and phase geometry upon new Molecule instantiation
    (according to _orient_molecule_internal)?
group_fragments
    Whether or not to group real fragments at the start of the atom list and ghost fragments toward the back.
    Previous to <code>v0.5</code>, this was always effectively True. True is handy for finding duplicate
    (atom-order-independent) molecules by hash. False preserves fragment order (though collapsing gaps for
    absent fragments) like Psi4's <code>extract_subsets</code>. False is handy for gradients where atom order of
    returned values matters.</p>
<h5 id="qcelemental.models.molecule.Molecule.get_fragment--returns">Returns<a class="headerlink" href="#qcelemental.models.molecule.Molecule.get_fragment--returns" title="Permanent link"></a></h5>
<p>mol
    New <code>py::class:qcelemental.model.Molecule</code> with <code>self</code>'s fragments present, ghosted, or absent.</p>

        <details class="quote">
          <summary>Source code in <code>qcelemental/models/molecule.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_fragment</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">real</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">],</span>
    <span class="n">ghost</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">orient</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">group_fragments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Molecule&quot;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Get new Molecule with fragments preserved, dropped, or ghosted.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    real</span>
<span class="sd">        Fragment index or list of indices (0-indexed) to be real atoms in new Molecule.</span>
<span class="sd">    ghost</span>
<span class="sd">        Fragment index or list of indices (0-indexed) to be ghost atoms (basis fns only) in new Molecule.</span>
<span class="sd">    orient</span>
<span class="sd">        Whether or not to align (inertial frame) and phase geometry upon new Molecule instantiation</span>
<span class="sd">        (according to _orient_molecule_internal)?</span>
<span class="sd">    group_fragments</span>
<span class="sd">        Whether or not to group real fragments at the start of the atom list and ghost fragments toward the back.</span>
<span class="sd">        Previous to ``v0.5``, this was always effectively True. True is handy for finding duplicate</span>
<span class="sd">        (atom-order-independent) molecules by hash. False preserves fragment order (though collapsing gaps for</span>
<span class="sd">        absent fragments) like Psi4&#39;s ``extract_subsets``. False is handy for gradients where atom order of</span>
<span class="sd">        returned values matters.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    mol</span>
<span class="sd">        New ``py::class:qcelemental.model.Molecule`` with ``self``\&#39;s fragments present, ghosted, or absent.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">real</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">real</span> <span class="o">=</span> <span class="p">[</span><span class="n">real</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ghost</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">ghost</span> <span class="o">=</span> <span class="p">[</span><span class="n">ghost</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">ghost</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ghost</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">constructor_dict</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">ret_name</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; (&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">real</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ghost</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="n">constructor_dict</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ret_name</span>
    <span class="c1"># ret = Molecule(None, name=ret_name)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">real</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">ghost</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="s2">&quot;Molecule:get_fragment: real and ghost sets are overlapping! (</span><span class="si">{0}</span><span class="s2">, </span><span class="si">{1}</span><span class="s2">).&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">real</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">ghost</span><span class="p">))</span>
        <span class="p">)</span>

    <span class="n">geom_blocks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">symbols</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">masses</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">real_atoms</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">fragments</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">fragment_charges</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">fragment_multiplicities</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">atom_size</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">group_fragments</span><span class="p">:</span>

        <span class="c1"># Loop through the real blocks</span>
        <span class="n">frag_start</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">frag</span> <span class="ow">in</span> <span class="n">real</span><span class="p">:</span>
            <span class="n">frag_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">[</span><span class="n">frag</span><span class="p">])</span>
            <span class="n">geom_blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">[</span><span class="n">frag</span><span class="p">]])</span>

            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">[</span><span class="n">frag</span><span class="p">]:</span>
                <span class="n">symbols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
                <span class="n">real_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">masses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">masses</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>

            <span class="n">fragments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">frag_start</span><span class="p">,</span> <span class="n">frag_start</span> <span class="o">+</span> <span class="n">frag_size</span><span class="p">)))</span>
            <span class="n">frag_start</span> <span class="o">+=</span> <span class="n">frag_size</span>

            <span class="n">fragment_charges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fragment_charges</span><span class="p">[</span><span class="n">frag</span><span class="p">]))</span>
            <span class="n">fragment_multiplicities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fragment_multiplicities</span><span class="p">[</span><span class="n">frag</span><span class="p">])</span>

        <span class="c1"># Set charge and multiplicity</span>
        <span class="n">constructor_dict</span><span class="p">[</span><span class="s2">&quot;molecular_charge&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">fragment_charges</span><span class="p">)</span>
        <span class="n">constructor_dict</span><span class="p">[</span><span class="s2">&quot;molecular_multiplicity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fragment_multiplicities</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="c1"># Loop through the ghost blocks</span>
        <span class="k">for</span> <span class="n">frag</span> <span class="ow">in</span> <span class="n">ghost</span><span class="p">:</span>
            <span class="n">frag_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">[</span><span class="n">frag</span><span class="p">])</span>
            <span class="n">geom_blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">[</span><span class="n">frag</span><span class="p">]])</span>

            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">[</span><span class="n">frag</span><span class="p">]:</span>
                <span class="n">symbols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
                <span class="n">real_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">masses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">masses</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>

            <span class="n">fragments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">frag_start</span><span class="p">,</span> <span class="n">frag_start</span> <span class="o">+</span> <span class="n">frag_size</span><span class="p">)))</span>
            <span class="n">frag_start</span> <span class="o">+=</span> <span class="n">frag_size</span>

            <span class="n">fragment_charges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">fragment_multiplicities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># List[Array[np.int32]]</span>
        <span class="n">at2fr</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ifr</span><span class="p">,</span> <span class="n">fr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">iat</span> <span class="ow">in</span> <span class="n">fr</span><span class="p">:</span>
                <span class="n">at2fr</span><span class="p">[</span><span class="n">iat</span><span class="p">]</span> <span class="o">=</span> <span class="n">ifr</span>

        <span class="n">at2at</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iat</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">)):</span>
            <span class="n">ifr</span> <span class="o">=</span> <span class="n">at2fr</span><span class="p">[</span><span class="n">iat</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">ifr</span> <span class="ow">in</span> <span class="n">real</span> <span class="ow">or</span> <span class="n">ifr</span> <span class="ow">in</span> <span class="n">ghost</span><span class="p">:</span>
                <span class="n">geom_blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="p">[</span><span class="n">iat</span><span class="p">])</span>
                <span class="n">symbols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="n">iat</span><span class="p">])</span>
                <span class="n">real_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ifr</span> <span class="ow">in</span> <span class="n">real</span><span class="p">)</span>
                <span class="n">masses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">masses</span><span class="p">[</span><span class="n">iat</span><span class="p">])</span>

                <span class="n">at2at</span><span class="p">[</span><span class="n">iat</span><span class="p">]</span> <span class="o">=</span> <span class="n">atom_size</span>
                <span class="n">atom_size</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">at2at</span><span class="p">[</span><span class="n">iat</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">for</span> <span class="n">ifr</span><span class="p">,</span> <span class="n">fr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">ifr</span> <span class="ow">in</span> <span class="n">real</span> <span class="ow">or</span> <span class="n">ifr</span> <span class="ow">in</span> <span class="n">ghost</span><span class="p">:</span>
                <span class="n">fragments</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">at2at</span><span class="p">[</span><span class="n">iat</span><span class="p">]</span> <span class="k">for</span> <span class="n">iat</span> <span class="ow">in</span> <span class="n">fr</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">ifr</span> <span class="ow">in</span> <span class="n">real</span><span class="p">:</span>
                <span class="n">fragment_charges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fragment_charges</span><span class="p">[</span><span class="n">ifr</span><span class="p">])</span>
                <span class="n">fragment_multiplicities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fragment_multiplicities</span><span class="p">[</span><span class="n">ifr</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">ifr</span> <span class="ow">in</span> <span class="n">ghost</span><span class="p">:</span>
                <span class="n">fragment_charges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">fragment_multiplicities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">assert</span> <span class="kc">None</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fragments</span>

    <span class="n">constructor_dict</span><span class="p">[</span><span class="s2">&quot;fragments&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fragments</span>
    <span class="n">constructor_dict</span><span class="p">[</span><span class="s2">&quot;fragment_charges&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fragment_charges</span>
    <span class="n">constructor_dict</span><span class="p">[</span><span class="s2">&quot;fragment_multiplicities&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fragment_multiplicities</span>
    <span class="n">constructor_dict</span><span class="p">[</span><span class="s2">&quot;symbols&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">symbols</span>
    <span class="n">constructor_dict</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">geom_blocks</span><span class="p">)</span>
    <span class="n">constructor_dict</span><span class="p">[</span><span class="s2">&quot;real&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">real_atoms</span>
    <span class="n">constructor_dict</span><span class="p">[</span><span class="s2">&quot;masses&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">masses</span>

    <span class="k">return</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="n">orient</span><span class="p">,</span> <span class="o">**</span><span class="n">constructor_dict</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.get_hash">
<code class="highlight language-python"><span class="n">get_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a class="headerlink" href="#qcelemental.models.molecule.Molecule.get_hash" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Returns the hash of the molecule.</p>

        <details class="quote">
          <summary>Source code in <code>qcelemental/models/molecule.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the hash of the molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">()</span>
    <span class="n">concat</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hash_fields</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field</span> <span class="o">==</span> <span class="s2">&quot;geometry&quot;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">float_prep</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">GEOMETRY_NOISE</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">field</span> <span class="o">==</span> <span class="s2">&quot;fragment_charges&quot;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">float_prep</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">CHARGE_NOISE</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">field</span> <span class="o">==</span> <span class="s2">&quot;molecular_charge&quot;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">float_prep</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">CHARGE_NOISE</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">field</span> <span class="o">==</span> <span class="s2">&quot;masses&quot;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">float_prep</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">MASS_NOISE</span><span class="p">)</span>

        <span class="n">concat</span> <span class="o">+=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

    <span class="n">m</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">concat</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.get_molecular_formula">
<code class="highlight language-python"><span class="n">get_molecular_formula</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;alphabetical&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>


<a class="headerlink" href="#qcelemental.models.molecule.Molecule.get_molecular_formula" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Returns the molecular formula for a molecule.</p>
<h5 id="qcelemental.models.molecule.Molecule.get_molecular_formula--parameters">Parameters<a class="headerlink" href="#qcelemental.models.molecule.Molecule.get_molecular_formula--parameters" title="Permanent link"></a></h5>
<div class="admonition order">
<p class="admonition-title">str, optional</p>
<p>Sorting order of the formula. Valid choices are "alphabetical" and "hill".</p>
</div>
<h5 id="qcelemental.models.molecule.Molecule.get_molecular_formula--returns">Returns<a class="headerlink" href="#qcelemental.models.molecule.Molecule.get_molecular_formula--returns" title="Permanent link"></a></h5>
<p>str
    The molecular formula.</p>
<h5 id="qcelemental.models.molecule.Molecule.get_molecular_formula--examples">Examples<a class="headerlink" href="#qcelemental.models.molecule.Molecule.get_molecular_formula--examples" title="Permanent link"></a></h5>
<blockquote>
<blockquote>
<blockquote>
<p>methane = qcelemental.models.Molecule('''
... H      0.5288      0.1610      0.9359
... C      0.0000      0.0000      0.0000
... H      0.2051      0.8240     -0.6786
... H      0.3345     -0.9314     -0.4496
... H     -1.0685     -0.0537      0.1921
... ''')
methane.get_molecular_formula()
CH4</p>
<p>hcl = qcelemental.models.Molecule('''
... H      0.0000      0.0000      0.0000
... Cl     0.0000      0.0000      1.2000
... ''')
hcl.get_molecular_formula()
ClH</p>
</blockquote>
</blockquote>
</blockquote>

        <details class="quote">
          <summary>Source code in <code>qcelemental/models/molecule.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_molecular_formula</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;alphabetical&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the molecular formula for a molecule.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    order: str, optional</span>
<span class="sd">        Sorting order of the formula. Valid choices are &quot;alphabetical&quot; and &quot;hill&quot;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        The molecular formula.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; methane = qcelemental.models.Molecule(&#39;&#39;&#39;</span>
<span class="sd">    ... H      0.5288      0.1610      0.9359</span>
<span class="sd">    ... C      0.0000      0.0000      0.0000</span>
<span class="sd">    ... H      0.2051      0.8240     -0.6786</span>
<span class="sd">    ... H      0.3345     -0.9314     -0.4496</span>
<span class="sd">    ... H     -1.0685     -0.0537      0.1921</span>
<span class="sd">    ... &#39;&#39;&#39;)</span>
<span class="sd">    &gt;&gt;&gt; methane.get_molecular_formula()</span>
<span class="sd">    CH4</span>

<span class="sd">    &gt;&gt;&gt; hcl = qcelemental.models.Molecule(&#39;&#39;&#39;</span>
<span class="sd">    ... H      0.0000      0.0000      0.0000</span>
<span class="sd">    ... Cl     0.0000      0.0000      1.2000</span>
<span class="sd">    ... &#39;&#39;&#39;)</span>
<span class="sd">    &gt;&gt;&gt; hcl.get_molecular_formula()</span>
<span class="sd">    ClH</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">from</span> <span class="nn">..molutil</span> <span class="kn">import</span> <span class="n">molecular_formula_from_symbols</span>

    <span class="k">return</span> <span class="n">molecular_formula_from_symbols</span><span class="p">(</span><span class="n">symbols</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.json">
<code class="highlight language-python"><span class="n">json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.json" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Generate a JSON representation of the model, <code>include</code> and <code>exclude</code> arguments as per <code>dict()</code>.</p>
<p><code>encoder</code> is an optional function to supply as <code>default</code> to json.dumps(), other arguments as per <code>json.dumps()</code>.</p>

        <details class="quote">
          <summary>Source code in <code>qcelemental/models/molecule.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c1"># Alias JSON here from BaseModel to reflect dict changes</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.measure">
<code class="highlight language-python"><span class="n">measure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">measurements</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]],</span> <span class="o">*</span><span class="p">,</span> <span class="n">degrees</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span></code>


<a class="headerlink" href="#qcelemental.models.molecule.Molecule.measure" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Takes a measurement of the moleucle from the indicies provided.</p>
<h5 id="qcelemental.models.molecule.Molecule.measure--parameters">Parameters<a class="headerlink" href="#qcelemental.models.molecule.Molecule.measure--parameters" title="Permanent link"></a></h5>
<p>measurements : Union[List[int], List[List[int]]]
    Either a single list of indices or multiple. Return a distance, angle, or dihedral depending if
    2, 3, or 4 indices is provided, respectively. Values are returned in Bohr (distance) or degree.
degrees : bool, optional
    Returns degrees by default, radians otherwise.</p>
<h5 id="qcelemental.models.molecule.Molecule.measure--returns">Returns<a class="headerlink" href="#qcelemental.models.molecule.Molecule.measure--returns" title="Permanent link"></a></h5>
<p>Union[float, List[float]]
    Either a value or list of the measured values.</p>

        <details class="quote">
          <summary>Source code in <code>qcelemental/models/molecule.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">measure</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">measurements</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]],</span> <span class="o">*</span><span class="p">,</span> <span class="n">degrees</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes a measurement of the moleucle from the indicies provided.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    measurements : Union[List[int], List[List[int]]]</span>
<span class="sd">        Either a single list of indices or multiple. Return a distance, angle, or dihedral depending if</span>
<span class="sd">        2, 3, or 4 indices is provided, respectively. Values are returned in Bohr (distance) or degree.</span>
<span class="sd">    degrees : bool, optional</span>
<span class="sd">        Returns degrees by default, radians otherwise.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Union[float, List[float]]</span>
<span class="sd">        Either a value or list of the measured values.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">measure_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="p">,</span> <span class="n">measurements</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="n">degrees</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.nelectrons">
<code class="highlight language-python"><span class="n">nelectrons</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ifr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span></code>


<a class="headerlink" href="#qcelemental.models.molecule.Molecule.nelectrons" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Number of electrons.</p>
<h5 id="qcelemental.models.molecule.Molecule.nelectrons--parameters">Parameters<a class="headerlink" href="#qcelemental.models.molecule.Molecule.nelectrons--parameters" title="Permanent link"></a></h5>
<p>ifr : int, optional
    If not <code>None</code>, only compute for the <code>ifr</code>-th (0-indexed) fragment.</p>
<h5 id="qcelemental.models.molecule.Molecule.nelectrons--returns">Returns<a class="headerlink" href="#qcelemental.models.molecule.Molecule.nelectrons--returns" title="Permanent link"></a></h5>
<p>Number of electrons in entire molecule or in fragment.</p>

        <details class="quote">
          <summary>Source code in <code>qcelemental/models/molecule.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">nelectrons</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ifr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Number of electrons.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ifr : int, optional</span>
<span class="sd">        If not `None`, only compute for the `ifr`-th (0-indexed) fragment.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Number of electrons in entire molecule or in fragment.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Zeff</span> <span class="o">=</span> <span class="p">[</span><span class="n">z</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">real</span><span class="p">)</span> <span class="k">for</span> <span class="n">z</span><span class="p">,</span> <span class="n">real</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomic_numbers</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">real</span><span class="p">)]</span>

    <span class="k">if</span> <span class="n">ifr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">nel</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">Zeff</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">molecular_charge</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">nel</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">zf</span> <span class="k">for</span> <span class="n">iat</span><span class="p">,</span> <span class="n">zf</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Zeff</span><span class="p">)</span> <span class="k">if</span> <span class="n">iat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">[</span><span class="n">ifr</span><span class="p">]])</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragment_charges</span><span class="p">[</span><span class="n">ifr</span><span class="p">]</span>

    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">nel</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.nuclear_repulsion_energy">
<code class="highlight language-python"><span class="n">nuclear_repulsion_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ifr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span></code>


<a class="headerlink" href="#qcelemental.models.molecule.Molecule.nuclear_repulsion_energy" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Nuclear repulsion energy.</p>
<h5 id="qcelemental.models.molecule.Molecule.nuclear_repulsion_energy--parameters">Parameters<a class="headerlink" href="#qcelemental.models.molecule.Molecule.nuclear_repulsion_energy--parameters" title="Permanent link"></a></h5>
<p>ifr : int, optional
    If not <code>None</code>, only compute for the <code>ifr</code>-th (0-indexed) fragment.</p>
<h5 id="qcelemental.models.molecule.Molecule.nuclear_repulsion_energy--returns">Returns<a class="headerlink" href="#qcelemental.models.molecule.Molecule.nuclear_repulsion_energy--returns" title="Permanent link"></a></h5>
<p>Nuclear repulsion energy in entire molecule or in fragment.</p>

        <details class="quote">
          <summary>Source code in <code>qcelemental/models/molecule.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">nuclear_repulsion_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ifr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Nuclear repulsion energy.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ifr : int, optional</span>
<span class="sd">        If not `None`, only compute for the `ifr`-th (0-indexed) fragment.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Nuclear repulsion energy in entire molecule or in fragment.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Zeff</span> <span class="o">=</span> <span class="p">[</span><span class="n">z</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">real</span><span class="p">)</span> <span class="k">for</span> <span class="n">z</span><span class="p">,</span> <span class="n">real</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomic_numbers</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">real</span><span class="p">)]</span>
    <span class="n">atoms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

    <span class="k">if</span> <span class="n">ifr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">[</span><span class="n">ifr</span><span class="p">]</span>

    <span class="n">nre</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">iat1</span><span class="p">,</span> <span class="n">at1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">atoms</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">at2</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">[:</span><span class="n">iat1</span><span class="p">]:</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="p">[</span><span class="n">at1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="p">[</span><span class="n">at2</span><span class="p">])</span>
            <span class="n">nre</span> <span class="o">+=</span> <span class="n">Zeff</span><span class="p">[</span><span class="n">at1</span><span class="p">]</span> <span class="o">*</span> <span class="n">Zeff</span><span class="p">[</span><span class="n">at2</span><span class="p">]</span> <span class="o">/</span> <span class="n">dist</span>
    <span class="k">return</span> <span class="n">nre</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.orient_molecule">
<code class="highlight language-python"><span class="n">orient_molecule</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a class="headerlink" href="#qcelemental.models.molecule.Molecule.orient_molecule" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Centers the molecule and orients via inertia tensor before returning a new Molecule</p>

        <details class="quote">
          <summary>Source code in <code>qcelemental/models/molecule.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">orient_molecule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Centers the molecule and orients via inertia tensor before returning a new Molecule</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.pretty_print">
<code class="highlight language-python"><span class="n">pretty_print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a class="headerlink" href="#qcelemental.models.molecule.Molecule.pretty_print" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Print the molecule in Angstroms. Same as <img alt="" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/1f1f5-1f1fe.svg" title=":py:" />func:<code>print_out</code> only always in Angstroms.
(method name in libmints is print_in_angstrom)</p>

        <details class="quote">
          <summary>Source code in <code>qcelemental/models/molecule.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">pretty_print</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Print the molecule in Angstroms. Same as :py:func:`print_out` only always in Angstroms.</span>
<span class="sd">    (method name in libmints is print_in_angstrom)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;    Geometry (in </span><span class="si">{0:s}</span><span class="s2">), charge = </span><span class="si">{1:.1f}</span><span class="s2">, multiplicity = </span><span class="si">{2:d}</span><span class="s2">:</span><span class="se">\n\n</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="s2">&quot;Angstrom&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">molecular_charge</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">molecular_multiplicity</span>
    <span class="p">)</span>
    <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;       Center              X                  Y                   Z       </span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
    <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;    ------------   -----------------  -----------------  -----------------</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="p">)):</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;    </span><span class="si">{0:8s}{1:4s}</span><span class="s2"> &quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">real</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;(Gh)&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  </span><span class="si">{0:17.12f}</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">conversion_factor</span><span class="p">(</span><span class="s2">&quot;bohr&quot;</span><span class="p">,</span> <span class="s2">&quot;angstroms&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="c1"># text += &quot;\n&quot;</span>

    <span class="k">return</span> <span class="n">text</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.scramble">
<code class="highlight language-python"><span class="n">scramble</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">do_shift</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">do_rotate</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">do_resort</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">deflection</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">do_mirror</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">do_plot</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">do_test</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">run_to_completion</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">run_resorting</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span></code>


<a class="headerlink" href="#qcelemental.models.molecule.Molecule.scramble" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Generate a Molecule with random or directed translation, rotation, and atom shuffling.
Optionally, check that the aligner returns the opposite transformation.</p>
<h5 id="qcelemental.models.molecule.Molecule.scramble--parameters">Parameters<a class="headerlink" href="#qcelemental.models.molecule.Molecule.scramble--parameters" title="Permanent link"></a></h5>
<p>ref_mol : qcel.models.Molecule
    Molecule to perturb.
do_shift : bool or array-like, optional
    Whether to generate a random atom shift on interval [-3, 3) in each
    dimension (<code>True</code>) or leave at current origin. To shift by a specified
    vector, supply a 3-element list.
do_rotate : bool or array-like, optional
    Whether to generate a random 3D rotation according to algorithm of Arvo.
    To rotate by a specified matrix, supply a 9-element list of lists.
do_resort : bool or array-like, optional
    Whether to shuffle atoms (<code>True</code>) or leave 1st atom 1st, etc. (<code>False</code>).
    To specify shuffle, supply a nat-element list of indices.
deflection : float, optional
    If <code>do_rotate</code>, how random a rotation: 0.0 is no change, 0.1 is small
    perturbation, 1.0 is completely random.
do_mirror : bool, optional
    Whether to construct the mirror image structure by inverting y-axis.
do_plot : bool, optional
    Pops up a mpl plot showing before, after, and ref geometries.
do_test : bool, optional
    Additionally, run the aligner on the returned Molecule and check that
    opposite transformations obtained.
run_to_completion : bool, optional
    By construction, scrambled systems are fully alignable (final RMSD=0).
    Even so, <code>True</code> turns off the mechanism to stop when RMSD reaches zero
    and instead proceed to worst possible time.
run_resorting : bool, optional
    Even if atoms not shuffled, test the resorting machinery.
verbose : int, optional
    Print level.</p>
<h5 id="qcelemental.models.molecule.Molecule.scramble--returns">Returns<a class="headerlink" href="#qcelemental.models.molecule.Molecule.scramble--returns" title="Permanent link"></a></h5>
<p>Molecule, data
    Molecule is scrambled copy of <code>ref_mol</code> (self).
    <code>data['rmsd']</code> is RMSD [A] between <code>ref_mol</code> and the scrambled geometry.
    <code>data['mill']</code> is a AlignmentMill with fields
    (shift, rotation, atommap, mirror) that prescribe the transformation
    from <code>ref_mol</code> to the returned geometry.</p>
<h5 id="qcelemental.models.molecule.Molecule.scramble--raises">Raises<a class="headerlink" href="#qcelemental.models.molecule.Molecule.scramble--raises" title="Permanent link"></a></h5>
<p>AssertionError
    If <code>do_test=True</code> and aligner sanity check fails for any of the reverse
    transformations.</p>

        <details class="quote">
          <summary>Source code in <code>qcelemental/models/molecule.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">scramble</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">do_shift</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">do_rotate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">do_resort</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">deflection</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">do_mirror</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">do_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">do_test</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">run_to_completion</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">run_resorting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate a Molecule with random or directed translation, rotation, and atom shuffling.</span>
<span class="sd">    Optionally, check that the aligner returns the opposite transformation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ref_mol : qcel.models.Molecule</span>
<span class="sd">        Molecule to perturb.</span>
<span class="sd">    do_shift : bool or array-like, optional</span>
<span class="sd">        Whether to generate a random atom shift on interval [-3, 3) in each</span>
<span class="sd">        dimension (`True`) or leave at current origin. To shift by a specified</span>
<span class="sd">        vector, supply a 3-element list.</span>
<span class="sd">    do_rotate : bool or array-like, optional</span>
<span class="sd">        Whether to generate a random 3D rotation according to algorithm of Arvo.</span>
<span class="sd">        To rotate by a specified matrix, supply a 9-element list of lists.</span>
<span class="sd">    do_resort : bool or array-like, optional</span>
<span class="sd">        Whether to shuffle atoms (`True`) or leave 1st atom 1st, etc. (`False`).</span>
<span class="sd">        To specify shuffle, supply a nat-element list of indices.</span>
<span class="sd">    deflection : float, optional</span>
<span class="sd">        If `do_rotate`, how random a rotation: 0.0 is no change, 0.1 is small</span>
<span class="sd">        perturbation, 1.0 is completely random.</span>
<span class="sd">    do_mirror : bool, optional</span>
<span class="sd">        Whether to construct the mirror image structure by inverting y-axis.</span>
<span class="sd">    do_plot : bool, optional</span>
<span class="sd">        Pops up a mpl plot showing before, after, and ref geometries.</span>
<span class="sd">    do_test : bool, optional</span>
<span class="sd">        Additionally, run the aligner on the returned Molecule and check that</span>
<span class="sd">        opposite transformations obtained.</span>
<span class="sd">    run_to_completion : bool, optional</span>
<span class="sd">        By construction, scrambled systems are fully alignable (final RMSD=0).</span>
<span class="sd">        Even so, `True` turns off the mechanism to stop when RMSD reaches zero</span>
<span class="sd">        and instead proceed to worst possible time.</span>
<span class="sd">    run_resorting : bool, optional</span>
<span class="sd">        Even if atoms not shuffled, test the resorting machinery.</span>
<span class="sd">    verbose : int, optional</span>
<span class="sd">        Print level.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Molecule, data</span>
<span class="sd">        Molecule is scrambled copy of `ref_mol` (self).</span>
<span class="sd">        `data[&#39;rmsd&#39;]` is RMSD [A] between `ref_mol` and the scrambled geometry.</span>
<span class="sd">        `data[&#39;mill&#39;]` is a AlignmentMill with fields</span>
<span class="sd">        (shift, rotation, atommap, mirror) that prescribe the transformation</span>
<span class="sd">        from `ref_mol` to the returned geometry.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    AssertionError</span>
<span class="sd">        If `do_test=True` and aligner sanity check fails for any of the reverse</span>
<span class="sd">        transformations.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">..molutil.align</span> <span class="kn">import</span> <span class="n">compute_scramble</span>

    <span class="n">ref_mol</span> <span class="o">=</span> <span class="bp">self</span>
    <span class="n">rgeom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ref_mol</span><span class="o">.</span><span class="n">geometry</span><span class="p">)</span>
    <span class="n">rmass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ref_mol</span><span class="o">.</span><span class="n">masses</span><span class="p">)</span>
    <span class="n">relem</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ref_mol</span><span class="o">.</span><span class="n">symbols</span><span class="p">)</span>
    <span class="n">relez</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ref_mol</span><span class="o">.</span><span class="n">atomic_numbers</span><span class="p">)</span>
    <span class="n">runiq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">((</span><span class="n">sym</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mas</span><span class="p">))</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">sym</span><span class="p">,</span> <span class="n">mas</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">ref_mol</span><span class="o">.</span><span class="n">symbols</span><span class="p">),</span> <span class="n">ref_mol</span><span class="o">.</span><span class="n">masses</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="n">nat</span> <span class="o">=</span> <span class="n">rgeom</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">perturbation</span> <span class="o">=</span> <span class="n">compute_scramble</span><span class="p">(</span>
        <span class="n">rgeom</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">do_shift</span><span class="o">=</span><span class="n">do_shift</span><span class="p">,</span>
        <span class="n">do_rotate</span><span class="o">=</span><span class="n">do_rotate</span><span class="p">,</span>
        <span class="n">deflection</span><span class="o">=</span><span class="n">deflection</span><span class="p">,</span>
        <span class="n">do_resort</span><span class="o">=</span><span class="n">do_resort</span><span class="p">,</span>
        <span class="n">do_mirror</span><span class="o">=</span><span class="n">do_mirror</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">cgeom</span><span class="p">,</span> <span class="n">cmass</span><span class="p">,</span> <span class="n">celem</span><span class="p">,</span> <span class="n">celez</span><span class="p">,</span> <span class="n">cuniq</span> <span class="o">=</span> <span class="n">perturbation</span><span class="o">.</span><span class="n">align_system</span><span class="p">(</span><span class="n">rgeom</span><span class="p">,</span> <span class="n">rmass</span><span class="p">,</span> <span class="n">relem</span><span class="p">,</span> <span class="n">relez</span><span class="p">,</span> <span class="n">runiq</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">cmolrec</span> <span class="o">=</span> <span class="n">from_arrays</span><span class="p">(</span>
        <span class="n">geom</span><span class="o">=</span><span class="n">cgeom</span><span class="p">,</span>
        <span class="n">mass</span><span class="o">=</span><span class="n">cmass</span><span class="p">,</span>
        <span class="n">elem</span><span class="o">=</span><span class="n">celem</span><span class="p">,</span>
        <span class="n">elez</span><span class="o">=</span><span class="n">celez</span><span class="p">,</span>
        <span class="n">units</span><span class="o">=</span><span class="s2">&quot;Bohr&quot;</span><span class="p">,</span>
        <span class="n">molecular_charge</span><span class="o">=</span><span class="n">ref_mol</span><span class="o">.</span><span class="n">molecular_charge</span><span class="p">,</span>
        <span class="n">molecular_multiplicity</span><span class="o">=</span><span class="n">ref_mol</span><span class="o">.</span><span class="n">molecular_multiplicity</span><span class="p">,</span>
        <span class="c1"># copying fix_* vals rather than outright True. neither way great</span>
        <span class="n">fix_com</span><span class="o">=</span><span class="n">ref_mol</span><span class="o">.</span><span class="n">fix_com</span><span class="p">,</span>
        <span class="n">fix_orientation</span><span class="o">=</span><span class="n">ref_mol</span><span class="o">.</span><span class="n">fix_orientation</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">cmol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">to_schema</span><span class="p">(</span><span class="n">cmolrec</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

    <span class="n">rmsd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">cgeom</span> <span class="o">-</span> <span class="n">rgeom</span><span class="p">)</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">bohr2angstroms</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">nat</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Start RMSD = </span><span class="si">{:8.4f}</span><span class="s2"> [A]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rmsd</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">do_test</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">cmol</span><span class="o">.</span><span class="n">align</span><span class="p">(</span>
            <span class="n">ref_mol</span><span class="p">,</span>
            <span class="n">do_plot</span><span class="o">=</span><span class="n">do_plot</span><span class="p">,</span>
            <span class="n">atoms_map</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="n">do_resort</span><span class="p">),</span>
            <span class="n">run_resorting</span><span class="o">=</span><span class="n">run_resorting</span><span class="p">,</span>
            <span class="n">mols_align</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">run_to_completion</span><span class="o">=</span><span class="n">run_to_completion</span><span class="p">,</span>
            <span class="n">run_mirror</span><span class="o">=</span><span class="n">do_mirror</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">solution</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;mill&quot;</span><span class="p">]</span>

        <span class="k">assert</span> <span class="n">compare</span><span class="p">(</span>
            <span class="kc">True</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">solution</span><span class="o">.</span><span class="n">shift</span><span class="p">,</span> <span class="n">perturbation</span><span class="o">.</span><span class="n">shift</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span> <span class="s2">&quot;shifts equiv&quot;</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="p">(</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">do_resort</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">compare</span><span class="p">(</span>
                <span class="kc">True</span><span class="p">,</span>
                <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">solution</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">perturbation</span><span class="o">.</span><span class="n">rotation</span><span class="p">),</span>
                <span class="s2">&quot;rotations transpose&quot;</span><span class="p">,</span>
                <span class="n">quiet</span><span class="o">=</span><span class="p">(</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">solution</span><span class="o">.</span><span class="n">mirror</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">compare</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">do_mirror</span><span class="p">,</span> <span class="s2">&quot;mirror allowed&quot;</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="p">(</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">cmol</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;rmsd&quot;</span><span class="p">:</span> <span class="n">rmsd</span><span class="p">,</span> <span class="s2">&quot;mill&quot;</span><span class="p">:</span> <span class="n">perturbation</span><span class="p">}</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.serialize">
<code class="highlight language-python"><span class="n">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encoding</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">include</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">exclude</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">exclude_unset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">exclude_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">exclude_none</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a class="headerlink" href="#qcelemental.models.molecule.Molecule.serialize" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Generates a serialized representation of the model</p>
<h5 id="qcelemental.models.molecule.Molecule.serialize--parameters">Parameters<a class="headerlink" href="#qcelemental.models.molecule.Molecule.serialize--parameters" title="Permanent link"></a></h5>
<p>encoding : str
    The serialization type, available types are: {'json', 'json-ext', 'msgpack-ext'}
include : Optional[Set[str]], optional
    Fields to be included in the serialization.
exclude : Optional[Set[str]], optional
    Fields to be excluded in the serialization.
exclude_unset : Optional[bool], optional
    If True, skips fields that have default values provided.</p>
<div class="admonition exclude_defaults">
<p class="admonition-title">Optional[bool], optional</p>
<p>If True, skips fields that have set or defaulted values equal to the default.</p>
</div>
<div class="admonition exclude_none">
<p class="admonition-title">Optional[bool], optional</p>
<p>If True, skips fields that have value <code>None</code>.</p>
</div>
<h5 id="qcelemental.models.molecule.Molecule.serialize--returns">Returns<a class="headerlink" href="#qcelemental.models.molecule.Molecule.serialize--returns" title="Permanent link"></a></h5>
<p>Union[bytes, str]
    The serialized model.</p>

        <details class="quote">
          <summary>Source code in <code>qcelemental/models/molecule.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Generates a serialized representation of the model</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    encoding : str</span>
<span class="sd">        The serialization type, available types are: {&#39;json&#39;, &#39;json-ext&#39;, &#39;msgpack-ext&#39;}</span>
<span class="sd">    include : Optional[Set[str]], optional</span>
<span class="sd">        Fields to be included in the serialization.</span>
<span class="sd">    exclude : Optional[Set[str]], optional</span>
<span class="sd">        Fields to be excluded in the serialization.</span>
<span class="sd">    exclude_unset : Optional[bool], optional</span>
<span class="sd">        If True, skips fields that have default values provided.</span>
<span class="sd">    exclude_defaults: Optional[bool], optional</span>
<span class="sd">        If True, skips fields that have set or defaulted values equal to the default.</span>
<span class="sd">    exclude_none: Optional[bool], optional</span>
<span class="sd">        If True, skips fields that have value ``None``.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Union[bytes, str]</span>
<span class="sd">        The serialized model.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">include</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;include&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">include</span>
    <span class="k">if</span> <span class="n">exclude</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;exclude&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exclude</span>
    <span class="k">if</span> <span class="n">exclude_unset</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;exclude_unset&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exclude_unset</span>
    <span class="k">if</span> <span class="n">exclude_defaults</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;exclude_defaults&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exclude_defaults</span>
    <span class="k">if</span> <span class="n">exclude_none</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;exclude_none&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exclude_none</span>

    <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">serialize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.show">
<code class="highlight language-python"><span class="n">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ngl_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nglview</span><span class="o">.</span><span class="n">NGLWidget</span></code>


<a class="headerlink" href="#qcelemental.models.molecule.Molecule.show" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Creates a 3D representation of a moleucle that can be manipulated in Jupyter Notebooks and exported as
images (<code>.png</code>).</p>
<h5 id="qcelemental.models.molecule.Molecule.show--parameters">Parameters<a class="headerlink" href="#qcelemental.models.molecule.Molecule.show--parameters" title="Permanent link"></a></h5>
<p>ngl_kwargs : Optional[Dict[str, Any]], optional
    Addition nglview NGLWidget kwargs</p>
<h5 id="qcelemental.models.molecule.Molecule.show--returns">Returns<a class="headerlink" href="#qcelemental.models.molecule.Molecule.show--returns" title="Permanent link"></a></h5>
<p>nglview.NGLWidget
    A nglview view of the molecule</p>

        <details class="quote">
          <summary>Source code in <code>qcelemental/models/molecule.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ngl_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;nglview.NGLWidget&quot;</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
    <span class="sd">&quot;&quot;&quot;Creates a 3D representation of a moleucle that can be manipulated in Jupyter Notebooks and exported as</span>
<span class="sd">    images (`.png`).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ngl_kwargs : Optional[Dict[str, Any]], optional</span>
<span class="sd">        Addition nglview NGLWidget kwargs</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    nglview.NGLWidget</span>
<span class="sd">        A nglview view of the molecule</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">which_import</span><span class="p">(</span><span class="s2">&quot;nglview&quot;</span><span class="p">,</span> <span class="n">return_bool</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ModuleNotFoundError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Python module nglwview not found. Solve by installing it: `conda install -c conda-forge nglview`&quot;</span>
        <span class="p">)</span>  <span class="c1"># pragma: no cover</span>

    <span class="kn">import</span> <span class="nn">nglview</span> <span class="k">as</span> <span class="nn">nv</span>  <span class="c1"># type: ignore</span>

    <span class="k">if</span> <span class="n">ngl_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ngl_kwargs</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">structure</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">TextStructure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="s2">&quot;nglview-sdf&quot;</span><span class="p">),</span> <span class="n">ext</span><span class="o">=</span><span class="s2">&quot;sdf&quot;</span><span class="p">)</span>
    <span class="n">widget</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">NGLWidget</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="o">**</span><span class="n">ngl_kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">widget</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.to_file">
<code class="highlight language-python"><span class="n">to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>


<a class="headerlink" href="#qcelemental.models.molecule.Molecule.to_file" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Writes the Molecule to a file.</p>
<h5 id="qcelemental.models.molecule.Molecule.to_file--parameters">Parameters<a class="headerlink" href="#qcelemental.models.molecule.Molecule.to_file--parameters" title="Permanent link"></a></h5>
<p>filename : str
    The filename to write to
dtype : Optional[str], optional
    The type of file to write, attempts to infer dtype from the filename if not provided.</p>

        <details class="quote">
          <summary>Source code in <code>qcelemental/models/molecule.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Writes the Molecule to a file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename : str</span>
<span class="sd">        The filename to write to</span>
<span class="sd">    dtype : Optional[str], optional</span>
<span class="sd">        The type of file to write, attempts to infer dtype from the filename if not provided.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ext</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span>

    <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">_extension_map</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">_extension_map</span><span class="p">[</span><span class="n">ext</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not infer dtype from filename: `</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">`&quot;</span><span class="p">)</span>

    <span class="n">flags</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span>
    <span class="k">if</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;xyz&quot;</span><span class="p">,</span> <span class="s2">&quot;xyz+&quot;</span><span class="p">,</span> <span class="s2">&quot;psi4&quot;</span><span class="p">]:</span>
        <span class="n">stringified</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;json&quot;</span><span class="p">]:</span>
        <span class="n">stringified</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;msgpack&quot;</span><span class="p">,</span> <span class="s2">&quot;msgpack-ext&quot;</span><span class="p">]:</span>
        <span class="n">stringified</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="s2">&quot;msgpack-ext&quot;</span><span class="p">)</span>
        <span class="n">flags</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span>
    <span class="k">elif</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;numpy&quot;</span><span class="p">]:</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atomic_numbers</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">npmol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">elements</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">conversion_factor</span><span class="p">(</span><span class="s2">&quot;bohr&quot;</span><span class="p">,</span> <span class="s2">&quot;angstroms&quot;</span><span class="p">)))</span>
        <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">npmol</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dtype `</span><span class="si">{</span><span class="n">dtype</span><span class="si">}</span><span class="s2">` is not valid&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
        <span class="n">handle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">stringified</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="qcelemental.models.molecule.Molecule.to_string">
<code class="highlight language-python"><span class="n">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">units</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">atom_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ghost_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span> <span class="n">prec</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="n">return_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span></code>


<a class="headerlink" href="#qcelemental.models.molecule.Molecule.to_string" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Returns a string that can be used by a variety of programs.</p>
<p>Unclear if this will be removed or renamed to "to_psi4_string" in the future</p>
<p>Suggest psi4 --&gt; psi4frag and psi4 route to to_string</p>

        <details class="quote">
          <summary>Source code in <code>qcelemental/models/molecule.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">units</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">atom_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ghost_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span>
    <span class="n">prec</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
    <span class="n">return_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a string that can be used by a variety of programs.</span>

<span class="sd">    Unclear if this will be removed or renamed to &quot;to_psi4_string&quot; in the future</span>

<span class="sd">    Suggest psi4 --&gt; psi4frag and psi4 route to to_string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">molrec</span> <span class="o">=</span> <span class="n">from_schema</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">(),</span> <span class="n">nonphysical</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">to_string</span><span class="p">(</span>
        <span class="n">molrec</span><span class="p">,</span>
        <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
        <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span>
        <span class="n">atom_format</span><span class="o">=</span><span class="n">atom_format</span><span class="p">,</span>
        <span class="n">ghost_format</span><span class="o">=</span><span class="n">ghost_format</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
        <span class="n">prec</span><span class="o">=</span><span class="n">prec</span><span class="p">,</span>
        <span class="n">return_data</span><span class="o">=</span><span class="n">return_data</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../FutureResult/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              FutureResult
            </div>
          </div>
        </a>
      
      
        <a href="../AtomicInput/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              AtomicInput
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "navigation.instant", "navigation.expand"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.ca5457b8.min.js"></script>
      
    
  </body>
</html>